- job:
    name: 'satellite6-libvirt-install'
    description: |
        Quickly up an instance using VLANs for feature and Bug testing. We could use the two new physical hardware which were
        recently procured. This would help fully automate sat6 installation to do Libvirt, RHEVM and Openstack CR Testing.
    node: sat6-rhel6
    parameters:
        - choice:
            name: PROVISIONING_ID
            choices:
                - 'basil'
                - 'paprika'
                - 'rosemary'
            description: |
                Though all the 3 are valid choices, the recommended one to choose is paprika for the below Server ID's, basil is used for
                robottelo-automation and rosemary is planned for Sat6 HA.
        - choice:
            name: SERVER_ID
            choices:
                - 'testing-rhel7'
                - 'testing-rhel6'
                - 'sat-feature-rhel7'
                - 'cap-feature-rhel7'
                - 'sat-feature-rhel6'
                - 'cap-feature-rhel6'
            description: |
                All the Server ID's here except the capsules have a bare-metal box in it's VLAN. Those bare-metal boxes can
                be accessed via the Management console to power ON and OFF. Look out for RDU Lab link for more details.
        - choice:
            name: SATELLITE_DISTRIBUTION
            choices:
                - 'INTERNAL AK'
                - 'INTERNAL'
                - 'INTERNAL REPOFILE'
                - 'GA'
            description: |
                INTERNAL AK and INTERNAL REPOFILE choices are valid currently only for sat6.3
        - choice:
            name: SATELLITE_VERSION
            choices:
                - '6.3'
                - '6.2'
                - '6.1'
                - '6.0'
        - choice:
            name: DISTRO
            choices:
                - 'rhel7'
                - 'rhel6'
        - string:
            name: BASE_URL
            description: Required when Satellite distribution is INTERNAL
        - bool:
            name: MINIMAL_INSTALL
            default: true
            description: "By default, Minimal Install is selected and it only syncs content of RHEL6-x86_64 and RHEL7-x86_64."
        - choice:
            name: SELINUX_MODE
            choices:
                - 'enforcing'
                - 'permissive'
        - choice:
            name: PROXY_MODE
            choices:
                - 'authenticated'
                - 'non-authenticated'
                - 'no-proxy'
        - bool:
            name: STAGE_TEST
            default: false
            description: |
                Points to RHSM stage for stage installation test. Used only
                in CDN provisioning.
        - satellite6-authentication-parameters
    scm:
        - git:
            url: https://github.com/SatelliteQE/automation-tools.git
            branches:
                - origin/master
            skip-tag: true
    wrappers:
        - default-wrappers
        - config-file-provider:
            files:
                - file-id: bc5f0cbc-616f-46de-bdfe-2e024e84fcbf
                  variable: CONFIG_FILES
        - build-name:
            name: '#${BUILD_NUMBER} ${ENV,var="PROVISIONING_ID"} ${ENV,var="SERVER_ID"} ${ENV,var="SATELLITE_VERSION"} ${ENV,var="DISTRO"}'
    builders:
        - shining-panda:
            build-environment: virtualenv
            python-version: System-CPython-2.7
            clear: true
            nature: shell
            command:
                !include-raw:
                    - 'pip-install-pycurl.sh'
                    - 'satellite6-libvirt-install.sh'
                    - 'satellite6-configure-variables.sh'

